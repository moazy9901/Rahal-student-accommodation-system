<p-toast></p-toast>

<div class="w-full from-[#f7f2ff] to-white dark:bg-gray-900">

  <!-- RIGHT FORM -->
  <div class="relative w-full z-30 flex items-center justify-center p-6 order-1 md:order-2">
    <div class="w-full bg-white/40 dark:bg-gray-900/40 backdrop-blur-xl shadow-xl rounded-3xl p-8 md:p-10 border border-white/30 dark:border-white/10 overflow-y-auto">
      <h2 class="text-4xl font-extrabold mb-2 text-center bg-gradient-to-r from-[#5e1fbf] to-[#9b4dff] text-transparent bg-clip-text">
        Create Professional Property
      </h2>
      <p class="text-center text-gray-600 dark:text-gray-300 mb-8">Fill in the details to list your property</p>

      <form [formGroup]="propertyForm" (ngSubmit)="submit()" class="space-y-5">

        <!-- SECTION 1: Basic Information -->
        <div class="border-b border-[#5e1fbf]/20 pb-6">
          <h3 class="text-lg font-bold text-[#5e1fbf] mb-4">Basic Information</h3>

          <!-- Title -->
          <div class="mb-4">
            <input
              type="text"
              placeholder="Property Title"
              formControlName="title"
              class="w-full bg-gray-200 dark:bg-gray-900 px-5 py-3 rounded-xl border border-[#5e1fbf]/40 text-gray-900 dark:text-white shadow-sm focus:ring-2 focus:ring-[#5e1fbf] outline-none transition"
            />
            <small *ngIf="f.title.touched && f.title.invalid" class="text-red-500 text-sm mt-1 block">
              <span *ngIf="f.title.errors['required']">Title is required</span>
              <span *ngIf="f.title.errors['minlength']">Minimum 5 characters</span>
            </small>
            <small *ngIf="f.title.errors?.server" class="text-red-500 text-sm mt-1 block">{{ f.title.errors.server }}</small>
          </div>

          <!-- Description -->
          <div class="mb-4">
            <textarea
              placeholder="Property Description"
              formControlName="description"
              class="w-full bg-gray-200 dark:bg-gray-900 px-5 py-3 rounded-xl border border-[#5e1fbf]/40 text-gray-900 dark:text-white shadow-sm focus:ring-2 focus:ring-[#5e1fbf] outline-none transition resize-none"
              rows="4"
            ></textarea>
            <small *ngIf="f.description.touched && f.description.invalid" class="text-red-500 text-sm mt-1 block">
              <span *ngIf="f.description.errors['required']">Description is required</span>
              <span *ngIf="f.description.errors['minlength']">Minimum 20 characters</span>
            </small>
            <small *ngIf="f.description.errors?.server" class="text-red-500 text-sm mt-1 block">{{ f.description.errors.server }}</small>
          </div>

          <!-- Price and Security Deposit -->
          <div class="grid grid-cols-2 gap-4">
            <div>
              <input
                type="number"
                placeholder="Price per Month"
                formControlName="price"
                class="w-full bg-gray-200 dark:bg-gray-900 px-5 py-3 rounded-xl border border-[#5e1fbf]/40 text-gray-900 dark:text-white shadow-sm focus:ring-2 focus:ring-[#5e1fbf] outline-none transition"
              />
              <small *ngIf="f.price.touched && f.price.invalid" class="text-red-500 text-sm mt-1 block">
                Price is required
              </small>
              <small *ngIf="f.price.errors?.server" class="text-red-500 text-sm mt-1 block">{{ f.price.errors.server }}</small>
            </div>
            <div>
              <input
                type="number"
                placeholder="Security Deposit"
                formControlName="security_deposit"
                class="w-full bg-gray-200 dark:bg-gray-900 px-5 py-3 rounded-xl border border-[#5e1fbf]/40 text-gray-900 dark:text-white shadow-sm focus:ring-2 focus:ring-[#5e1fbf] outline-none transition"
              />
              <small *ngIf="f.security_deposit.touched && f.security_deposit.invalid" class="text-red-500 text-sm mt-1 block">
                Deposit is required
              </small>
              <small *ngIf="f.security_deposit.errors?.server" class="text-red-500 text-sm mt-1 block">{{ f.security_deposit.errors.server }}</small>
            </div>
          </div>
        </div>

        <!-- SECTION 2: Location -->
        <div class="border-b border-[#5e1fbf]/20 pb-6">
          <h3 class="text-lg font-bold text-[#5e1fbf] mb-4">Location</h3>

          <!-- Address -->
          <div class="mb-4">
            <input
              type="text"
              placeholder="Street Address"
              formControlName="address"
              class="w-full bg-gray-200 dark:bg-gray-900 px-5 py-3 rounded-xl border border-[#5e1fbf]/40 text-gray-900 dark:text-white shadow-sm focus:ring-2 focus:ring-[#5e1fbf] outline-none transition"
            />
            <small *ngIf="f.address.touched && f.address.invalid" class="text-red-500 text-sm mt-1 block">
              Address is required
            </small>
            <small *ngIf="f.address.errors?.server" class="text-red-500 text-sm mt-1 block">{{ f.address.errors.server }}</small>
          </div>

          <!-- City -->
          <div class="relative w-full mb-4" [class.z-50]="cityOpen">
            <button
              type="button"
              (click)="cityOpen = !cityOpen"
              class="w-full bg-gray-200 dark:bg-gray-900 px-5 py-3 rounded-xl border border-[#5e1fbf]/40 text-gray-900 dark:text-white shadow-sm flex justify-between items-center focus:ring-2 focus:ring-[#5e1fbf] outline-none transition text-left"
            >
              {{ selectedCityName || 'Select City' }}
              <i class="fa" [ngClass]="cityOpen ? 'fa-chevron-up' : 'fa-chevron-down'"></i>
            </button>
            <ul
              *ngIf="cityOpen"
              class="absolute w-full mt-1 bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-700 rounded-xl shadow-lg overflow-hidden z-50"
            >
              <li
                *ngFor="let city of cities"
                (click)="selectCity(city)"
                class="px-5 py-3 hover:bg-blue-100 dark:hover:bg-gray-700 cursor-pointer text-gray-900 dark:text-white"
              >
                {{ city.name }}
              </li>
            </ul>
            <small *ngIf="f.city_id.touched && f.city_id.invalid" class="text-red-500 text-sm mt-1 block">
              City is required
            </small>
            <small *ngIf="f.city_id.errors?.server" class="text-red-500 text-sm mt-1 block">{{ f.city_id.errors.server }}</small>
          </div>

          <!-- Area -->
          <div class="relative w-full mb-4" [class.z-40]="areaOpen">
            <button
              type="button"
              (click)="areaOpen = !areaOpen"
              [disabled]="!selectedCityId"
              class="w-full bg-gray-200 dark:bg-gray-900 px-5 py-3 rounded-xl border border-[#5e1fbf]/40 text-gray-900 dark:text-white shadow-sm flex justify-between items-center focus:ring-2 focus:ring-[#5e1fbf] outline-none transition text-left disabled:opacity-50"
            >
              {{ selectedAreaName || 'Select Area' }}
              <i class="fa" [ngClass]="areaOpen ? 'fa-chevron-up' : 'fa-chevron-down'"></i>
            </button>
            <ul
              *ngIf="areaOpen && getAreaOptions().length > 0"
              class="absolute w-full mt-1 bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-700 rounded-xl shadow-lg overflow-hidden z-40"
            >
              <li
                *ngFor="let area of getAreaOptions()"
                (click)="selectArea(area)"
                class="px-5 py-3 hover:bg-blue-100 dark:hover:bg-gray-700 cursor-pointer text-gray-900 dark:text-white"
              >
                {{ area.name }}
              </li>
            </ul>
            <small *ngIf="f.area_id.touched && f.area_id.invalid" class="text-red-500 text-sm mt-1 block">
              Area is required
            </small>
            <small *ngIf="f.area_id.errors?.server" class="text-red-500 text-sm mt-1 block">{{ f.area_id.errors.server }}</small>
          </div>
        </div>

        <!-- SECTION 3: Property Details -->
        <div class="border-b border-[#5e1fbf]/20 pb-6">
          <h3 class="text-lg font-bold text-[#5e1fbf] mb-4">Property Details</h3>

          <!-- Accommodation Type and Gender -->
          <div class="grid grid-cols-2 gap-4 mb-4">
            <!-- Accommodation Type -->
            <div class="relative w-full" [class.z-30]="accommodationOpen">
              <button
                type="button"
                (click)="accommodationOpen = !accommodationOpen"
                class="w-full bg-gray-200 dark:bg-gray-900 px-5 py-3 rounded-xl border border-[#5e1fbf]/40 text-gray-900 dark:text-white shadow-sm flex justify-between items-center focus:ring-2 focus:ring-[#5e1fbf] outline-none transition text-left text-sm"
              >
                {{ selectedAccommodation || 'Type' }}
                <i class="fa" [ngClass]="accommodationOpen ? 'fa-chevron-up' : 'fa-chevron-down'"></i>
              </button>
              <ul
                *ngIf="accommodationOpen"
                class="absolute w-full mt-1 bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-700 rounded-xl shadow-lg overflow-hidden z-30"
              >
                <li
                  *ngFor="let acc of accommodationTypes"
                  (click)="selectAccommodation(acc)"
                  class="px-5 py-2 hover:bg-blue-100 dark:hover:bg-gray-700 cursor-pointer text-gray-900 dark:text-white text-sm"
                >
                  {{ acc }}
                </li>
              </ul>
            </div>

            <!-- Gender Requirement -->
            <div class="relative w-full" [class.z-20]="genderOpen">
              <button
                type="button"
                (click)="genderOpen = !genderOpen"
                class="w-full bg-gray-200 dark:bg-gray-900 px-5 py-3 rounded-xl border border-[#5e1fbf]/40 text-gray-900 dark:text-white shadow-sm flex justify-between items-center focus:ring-2 focus:ring-[#5e1fbf] outline-none transition text-left text-sm"
              >
                {{ selectedGender || 'Gender' }}
                <i class="fa" [ngClass]="genderOpen ? 'fa-chevron-up' : 'fa-chevron-down'"></i>
              </button>
              <ul
                *ngIf="genderOpen"
                class="absolute w-full mt-1 bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-700 rounded-xl shadow-lg overflow-hidden z-20"
              >
                <li
                  *ngFor="let gender of genderOptions"
                  (click)="selectGender(gender)"
                  class="px-5 py-2 hover:bg-blue-100 dark:hover:bg-gray-700 cursor-pointer text-gray-900 dark:text-white text-sm"
                >
                  {{ gender | titlecase }}
                </li>
              </ul>
            </div>
          </div>

          <!-- Rooms, Bathrooms, Beds, Size -->
          <div class="grid grid-cols-2 gap-4 mb-4">
            <div>
              <input
                type="number"
                placeholder="Total Rooms"
                formControlName="total_rooms"
                class="w-full bg-gray-200 dark:bg-gray-900 px-5 py-3 rounded-xl border border-[#5e1fbf]/40 text-gray-900 dark:text-white shadow-sm focus:ring-2 focus:ring-[#5e1fbf] outline-none transition"
              />
              <small *ngIf="f.total_rooms.touched && f.total_rooms.invalid" class="text-red-500 text-sm mt-1 block">
                Required
              </small>
              <small *ngIf="f.total_rooms.errors?.server" class="text-red-500 text-sm mt-1 block">{{ f.total_rooms.errors.server }}</small>
            </div>
            <div>
              <input
                type="number"
                placeholder="Available Rooms"
                formControlName="available_rooms"
                class="w-full bg-gray-200 dark:bg-gray-900 px-5 py-3 rounded-xl border border-[#5e1fbf]/40 text-gray-900 dark:text-white shadow-sm focus:ring-2 focus:ring-[#5e1fbf] outline-none transition"
              />
              <small *ngIf="f.available_rooms.touched && f.available_rooms.invalid" class="text-red-500 text-sm mt-1 block">
                Required
              </small>
              <small *ngIf="propertyForm.errors?.availableInvalid" class="text-red-500 text-sm mt-1 block">Available Rooms cannot exceed Total Rooms.</small>
              <small *ngIf="f.available_rooms.errors?.server" class="text-red-500 text-sm mt-1 block">{{ f.available_rooms.errors.server }}</small>
            </div>
            <div>
              <input
                type="number"
                placeholder="Bathrooms"
                formControlName="bathrooms_count"
                class="w-full bg-gray-200 dark:bg-gray-900 px-5 py-3 rounded-xl border border-[#5e1fbf]/40 text-gray-900 dark:text-white shadow-sm focus:ring-2 focus:ring-[#5e1fbf] outline-none transition"
              />
              <small *ngIf="f.bathrooms_count.touched && f.bathrooms_count.invalid" class="text-red-500 text-sm mt-1 block">
                Required
              </small>
              <small *ngIf="f.bathrooms_count.errors?.server" class="text-red-500 text-sm mt-1 block">{{ f.bathrooms_count.errors.server }}</small>
            </div>
            <div>
              <input
                type="number"
                placeholder="Beds"
                formControlName="beds"
                class="w-full bg-gray-200 dark:bg-gray-900 px-5 py-3 rounded-xl border border-[#5e1fbf]/40 text-gray-900 dark:text-white shadow-sm focus:ring-2 focus:ring-[#5e1fbf] outline-none transition"
              />
              <small *ngIf="f.beds.touched && f.beds.invalid" class="text-red-500 text-sm mt-1 block">
                Required
              </small>
              <small *ngIf="f.beds.errors?.server" class="text-red-500 text-sm mt-1 block">{{ f.beds.errors.server }}</small>
            </div>
            <div>
              <input
                type="number"
                placeholder="Available Spots"
                formControlName="available_spots"
                class="w-full bg-gray-200 dark:bg-gray-900 px-5 py-3 rounded-xl border border-[#5e1fbf]/40 text-gray-900 dark:text-white shadow-sm focus:ring-2 focus:ring-[#5e1fbf] outline-none transition"
              />
              <small *ngIf="f.available_spots.touched && f.available_spots.invalid" class="text-red-500 text-sm mt-1 block">
                Required
              </small>
              <small *ngIf="f.available_spots.errors?.server" class="text-red-500 text-sm mt-1 block">{{ f.available_spots.errors.server }}</small>
            </div>
            <div>
              <input
                type="number"
                placeholder="Size (sqm)"
                formControlName="size"
                class="w-full bg-gray-200 dark:bg-gray-900 px-5 py-3 rounded-xl border border-[#5e1fbf]/40 text-gray-900 dark:text-white shadow-sm focus:ring-2 focus:ring-[#5e1fbf] outline-none transition"
              />
              <small *ngIf="f.size.touched && f.size.invalid" class="text-red-500 text-sm mt-1 block">
                Required
              </small>
              <small *ngIf="f.size.errors?.server" class="text-red-500 text-sm mt-1 block">{{ f.size.errors.server }}</small>
            </div>
            <div>
              <input
                type="number"
                placeholder="Min Stay (months)"
                formControlName="minimum_stay_months"
                class="w-full bg-gray-200 dark:bg-gray-900 px-5 py-3 rounded-xl border border-[#5e1fbf]/40 text-gray-900 dark:text-white shadow-sm focus:ring-2 focus:ring-[#5e1fbf] outline-none transition"
              />
            </div>
          </div>

          <!-- University -->
          <div class="relative w-full mb-4" [class.z-30]="universityOpen">
            <button
              type="button"
              (click)="universityOpen = !universityOpen"
              [disabled]="!selectedCityId"
              class="w-full bg-gray-200 dark:bg-gray-900 px-5 py-3 rounded-xl border border-[#5e1fbf]/40 text-gray-900 dark:text-white shadow-sm flex justify-between items-center focus:ring-2 focus:ring-[#5e1fbf] outline-none transition text-left disabled:opacity-50">
              {{ selectedUniversityName || 'Select University' }}
              <i class="fa" [ngClass]="universityOpen ? 'fa-chevron-up' : 'fa-chevron-down'"></i>
            </button>

            <ul
              *ngIf="universityOpen && universities.length > 0"
              class="absolute w-full mt-1 bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-700 rounded-xl shadow-lg overflow-hidden z-30 max-h-60 overflow-y-auto">
              <li
                *ngFor="let uni of universities"
                (click)="selectUniversity(uni)"
                class="px-5 py-3 hover:bg-purple-100 dark:hover:bg-gray-700 cursor-pointer text-gray-900 dark:text-white flex items-center gap-2">
                <span>{{ uni.name }}</span>
                <span *ngIf="uni.abbreviation" class="text-xs text-gray-500">({{ uni.abbreviation }})</span>
              </li>
            </ul>

            <small *ngIf="f.university_id.touched && f.university_id.invalid" class="text-red-500 text-sm mt-1 block">
              University is required
            </small>
            <small *ngIf="f.university_id.errors?.server" class="text-red-500 text-sm mt-1 block">
              {{ f.university_id.errors.server }}
            </small>
          </div>
        </div>

        <!-- SECTION 4: Availability -->
        <div class="border-b border-[#5e1fbf]/20 pb-6">
          <h3 class="text-lg font-bold text-[#5e1fbf] mb-4">Availability</h3>

          <div class="grid grid-cols-2 gap-4">
            <div>
              <label class="block text-sm text-gray-700 dark:text-gray-300 mb-2">Available From</label>
              <input
                type="date"
                formControlName="available_from"
                class="w-full bg-gray-200 dark:bg-gray-900 px-5 py-3 rounded-xl border border-[#5e1fbf]/40 text-gray-900 dark:text-white shadow-sm focus:ring-2 focus:ring-[#5e1fbf] outline-none transition"
              />
              <small *ngIf="f.available_from.touched && f.available_from.invalid" class="text-red-500 text-sm mt-1 block">
                Required
              </small>
              <small *ngIf="f.available_from.errors?.server" class="text-red-500 text-sm mt-1 block">{{ f.available_from.errors.server }}</small>
              <small *ngIf="propertyForm.errors?.fromPastDate" class="text-red-500 text-sm mt-1 block">Available From date cannot be in the past.</small>
            </div>
            <div>
              <label class="block text-sm text-gray-700 dark:text-gray-300 mb-2">Available Until</label>
              <input
                type="date"
                formControlName="available_to"
                class="w-full bg-gray-200 dark:bg-gray-900 px-5 py-3 rounded-xl border border-[#5e1fbf]/40 text-gray-900 dark:text-white shadow-sm focus:ring-2 focus:ring-[#5e1fbf] outline-none transition"
              />
              <small *ngIf="f.available_to.touched && f.available_to.invalid" class="text-red-500 text-sm mt-1 block">
                Required
              </small>

              <small *ngIf="f.available_to.errors?.server" class="text-red-500 text-sm mt-1 block">{{ f.available_to.errors.server }}</small>
              <small *ngIf="propertyForm.errors?.dateInvalid" class="text-red-500 text-sm mt-1 block">Available Until date must be after Available From date.</small>
              <small *ngIf="propertyForm.errors?.toPastDate" class="text-red-500 text-sm mt-1 block">Available Until date cannot be in the past.</small>
            </div>
          </div>
        </div>

        <!-- SECTION 5: Amenities -->
        <div class="border-b border-[#5e1fbf]/20 pb-6">
          <h3 class="text-lg font-bold text-[#5e1fbf] mb-4">Amenities</h3>

          <div class="grid grid-cols-2 gap-3">
            <button
              type="button"
              *ngFor="let amenity of amenities"
              (click)="toggleAmenity(amenity.id)"
              [class.ring-2]="isAmenitySelected(amenity.id)"
              class="p-3 rounded-lg border-2 border-[#5e1fbf]/40 bg-gray-200 dark:bg-gray-900 text-gray-900 dark:text-white transition"
            >
              {{ amenity.name }}
            </button>
          </div>
          <small *ngIf="f.amenities.errors?.server" class="text-red-500 text-sm mt-1 block">{{ f.amenities.errors.server }}</small>
        </div>

        <!-- SECTION 5.5: Payment Methods -->
        <div class="border-b border-[#5e1fbf]/20 pb-6">
          <h3 class="text-lg font-bold text-[#5e1fbf] mb-4">Payment Methods</h3>

          <div class="grid grid-cols-3 gap-3">
            <button
              type="button"
              *ngFor="let method of paymentMethods"
              (click)="togglePaymentMethod(method)"
              [class.ring-2]="isPaymentMethodSelected(method)"
              [class.ring-[#5e1fbf]]="isPaymentMethodSelected(method)"
              [class.bg-[#5e1fbf]/10]="isPaymentMethodSelected(method)"
              class="p-3 rounded-lg border-2 border-[#5e1fbf]/40 bg-gray-200 dark:bg-gray-900 text-gray-900 dark:text-white transition capitalize"
            >
              {{ method.replace('_', ' ') }}
            </button>
          </div>
          <small *ngIf="f.payment_methods.errors?.server" class="text-red-500 text-sm mt-1 block">{{ f.payment_methods.errors.server }}</small>
        </div>

        <!-- SECTION 6: Features & Contact -->
        <div class="border-b border-[#5e1fbf]/20 pb-6">
          <h3 class="text-lg font-bold text-[#5e1fbf] mb-4">Features & Contact</h3>

          <!-- Toggles -->
          <div class="grid grid-cols-2 gap-4 mb-4">
            <label class="flex items-center gap-3 cursor-pointer">
              <input
                type="checkbox"
                formControlName="smoking_allowed"
                class="w-5 h-5 rounded border-[#5e1fbf]/40 accent-[#5e1fbf]"
              />
              <span class="text-gray-900 dark:text-white">Smoking Allowed</span>
            </label>
            <label class="flex items-center gap-3 cursor-pointer">
              <input
                type="checkbox"
                formControlName="pets_allowed"
                class="w-5 h-5 rounded border-[#5e1fbf]/40 accent-[#5e1fbf]"
              />
              <span class="text-gray-900 dark:text-white">Pets Allowed</span>
            </label>
            <label class="flex items-center gap-3 cursor-pointer">
              <input
                type="checkbox"
                formControlName="furnished"
                class="w-5 h-5 rounded border-[#5e1fbf]/40 accent-[#5e1fbf]"
              />
              <span class="text-gray-900 dark:text-white">Furnished</span>
            </label>
            <label class="flex items-center gap-3 cursor-pointer">
              <input
                type="checkbox"
                formControlName="is_negotiable"
                class="w-5 h-5 rounded border-[#5e1fbf]/40 accent-[#5e1fbf]"
              />
              <span class="text-gray-900 dark:text-white">Price Negotiable</span>
            </label>
          </div>

          <!-- Contact Information -->
          <div class="grid grid-cols-2 gap-4">
            <div>
              <input
                type="tel"
                placeholder="Contact Phone"
                formControlName="contact_phone"
                class="w-full bg-gray-200 dark:bg-gray-900 px-5 py-3 rounded-xl border border-[#5e1fbf]/40 text-gray-900 dark:text-white shadow-sm focus:ring-2 focus:ring-[#5e1fbf] outline-none transition"
              />
              <small *ngIf="f.contact_phone.touched && f.contact_phone.invalid" class="text-red-500 text-sm mt-1 block">
                Valid phone required
              </small>
              <small *ngIf="f.contact_phone.errors?.server" class="text-red-500 text-sm mt-1 block">{{ f.contact_phone.errors.server }}</small>
            </div>
            <div>
              <input
                type="email"
                placeholder="Contact Email"
                formControlName="contact_email"
                class="w-full bg-gray-200 dark:bg-gray-900 px-5 py-3 rounded-xl border border-[#5e1fbf]/40 text-gray-900 dark:text-white shadow-sm focus:ring-2 focus:ring-[#5e1fbf] outline-none transition"
              />
              <small *ngIf="f.contact_email.touched && f.contact_email.invalid" class="text-red-500 text-sm mt-1 block">
                Valid email required
              </small>
              <small *ngIf="f.contact_email.errors?.server" class="text-red-500 text-sm mt-1 block">{{ f.contact_email.errors.server }}</small>
            </div>
          </div>
        </div>

        <!-- SECTION 7: Images -->
        <div class="border-b border-[#5e1fbf]/20 pb-6">
          <h3 class="text-lg font-bold text-[#5e1fbf] mb-4">Property Images</h3>

          <!-- Upload Button -->
          <label
            class="block w-full p-6 border-2 border-dashed border-[#5e1fbf]/40 rounded-xl cursor-pointer hover:border-[#7a30e3] hover:shadow-lg transition bg-gray-200 dark:bg-gray-900 text-center"
          >
            <div class="text-gray-600 dark:text-gray-300">
              <i class="fa fa-cloud-upload text-2xl mb-2 block"></i>
              <span>Click to upload images</span>
            </div>
            <input
              type="file"
              multiple
              accept="image/*"
              (change)="onFileChange($event)"
              class="opacity-0 absolute"
            />
          </label>
          <small *ngIf="f.images.errors?.server" class="text-red-500 text-sm mt-1 block">{{ f.images.errors.server }}</small>

          <!-- Image Previews -->
          <div class="grid grid-cols-3 gap-4 mt-4">
            <div *ngFor="let image of previewImages; let i = index" class="relative group">
              <img [src]="image" alt="Preview" class="w-full h-32 object-cover rounded-lg" />
              <button
                type="button"
                (click)="removeImage(i)"
                class="absolute top-2 right-2 bg-red-500 text-white p-2 rounded-full opacity-0 group-hover:opacity-100 transition"
              >
                <i class="fa fa-times"></i>
              </button>
            </div>
          </div>
        </div>

        <!-- Submit Button -->
        <button
          type="submit"
          [disabled]="isSubmitting || propertyForm.invalid"
          class="w-full text-white py-3.5 rounded-xl text-base font-semibold bg-gradient-to-r from-[#5e1fbf] to-[#7a30e3] hover:opacity-90 transition shadow-lg disabled:opacity-50 mt-6"
        >
          {{ isSubmitting ? 'Creating Property...' : 'Create Property' }}
        </button>
      </form>
    </div>
  </div>
</div>
