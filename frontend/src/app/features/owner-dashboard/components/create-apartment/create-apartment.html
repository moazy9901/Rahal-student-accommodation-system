<div class="max-w-5xl mx-auto py-10 space-y-10 text-gray-900 dark:text-gray-100">

  <!-- Page Title -->
  <h1 class="text-3xl font-bold text-center mb-6 flex items-center justify-center gap-3">
    <i class="fas fa-building text-orange-500"></i>
    Create Apartment Listing
  </h1>

  <form [formGroup]="form" class="space-y-10">

    <!-- BASIC INFO -->
    <h2 class="text-xl font-semibold flex items-center gap-2">
      <i class="fas fa-info-circle text-orange-500"></i> Basic Information
    </h2>

    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
      <!-- Title -->
      <div>
        <label class="label"><i class="fas fa-heading"></i> Title</label>
        <input type="text" placeholder="Apartment Title" formControlName="title" class="input-field" />
        <p *ngIf="form.get('title')?.touched && form.get('title')?.hasError('required')" class="text-red-600 text-sm">Title is required.</p>
        <p *ngIf="form.get('title')?.touched && form.get('title')?.hasError('minlength')" class="text-red-600 text-sm">Title must be at least 5 characters.</p>
        <p *ngIf="form.get('title')?.errors?.['server']" class="text-red-600 text-sm">{{ form.get('title')?.errors?.['server'] }}</p>
      </div>

      <!-- Address -->
      <div>
        <label class="label"><i class="fas fa-map-marker-alt"></i> Address</label>
        <input type="text" placeholder="Address" formControlName="address" class="input-field" />
        <p *ngIf="form.get('address')?.touched && form.get('address')?.hasError('required')" class="text-red-600 text-sm">Address is required.</p>
        <p *ngIf="form.get('address')?.touched && form.get('address')?.hasError('minlength')" class="text-red-600 text-sm">Address must be at least 5 characters.</p>
        <p *ngIf="form.get('address')?.errors?.['server']" class="text-red-600 text-sm">{{ form.get('address')?.errors?.['server'] }}</p>
      </div>
    </div>

    <!-- Description -->
    <div>
      <label class="label"><i class="fas fa-align-left"></i> Description</label>
      <textarea rows="5" placeholder="Description" formControlName="description" class="input-field"></textarea>
      <p *ngIf="form.get('description')?.touched && form.get('description')?.hasError('required')" class="text-red-600 text-sm">Description is required.</p>
      <p *ngIf="form.get('description')?.touched && form.get('description')?.hasError('minlength')" class="text-red-600 text-sm">Description must be at least 5 characters.</p>
      <p *ngIf="form.get('description')?.errors?.['server']" class="text-red-600 text-sm">{{ form.get('description')?.errors?.['server'] }}</p>
    </div>

    <!-- LOCATION -->
    <h2 class="text-xl font-semibold flex items-center gap-2">
      <i class="fas fa-location-dot text-orange-500"></i> Location
    </h2>

    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
      <!-- City -->
      <div>
        <label class="label">City</label>
        <input type="number" formControlName="city_id" class="input-field" />
        <p *ngIf="form.get('city_id')?.touched && form.get('city_id')?.hasError('required')" class="text-red-600 text-sm">City is required.</p>
        <p *ngIf="form.get('city_id')?.errors?.['server']" class="text-red-600 text-sm">{{ form.get('city_id')?.errors?.['server'] }}</p>
      </div>

      <!-- Area -->
      <div>
        <label class="label">Area</label>
        <input type="number" formControlName="area_id" class="input-field" />
        <p *ngIf="form.get('area_id')?.touched && form.get('area_id')?.hasError('required')" class="text-red-600 text-sm">Area is required.</p>
        <p *ngIf="form.get('area_id')?.errors?.['server']" class="text-red-600 text-sm">{{ form.get('area_id')?.errors?.['server'] }}</p>
      </div>
    </div>

    <!-- PROPERTY DETAILS -->
    <h2 class="text-xl font-semibold flex items-center gap-2">
      <i class="fas fa-door-open text-orange-500"></i> Property Details
    </h2>

    <div class="grid grid-cols-2 md:grid-cols-4 gap-6 p-6 border border-gray-300 rounded-xl dark:border-gray-700">
      <!-- Beds -->
      <div>
        <label class="label"><i class="fas fa-bed"></i> Beds</label>
        <input type="number" formControlName="beds" class="input-small" />
        <p *ngIf="form.get('beds')?.touched && form.get('beds')?.hasError('required')" class="text-red-600 text-sm">Beds is required.</p>
        <p *ngIf="form.get('beds')?.errors?.['server']" class="text-red-600 text-sm">{{ form.get('beds')?.errors?.['server'] }}</p>
      </div>

      <!-- Bathrooms -->
      <div>
        <label class="label"><i class="fas fa-bath"></i> Bathrooms</label>
        <input type="number" formControlName="bathrooms_count" class="input-small" />
        <p *ngIf="form.get('bathrooms_count')?.touched && form.get('bathrooms_count')?.hasError('required')" class="text-red-600 text-sm">Bathrooms is required.</p>
        <p *ngIf="form.get('bathrooms_count')?.errors?.['server']" class="text-red-600 text-sm">{{ form.get('bathrooms_count')?.errors?.['server'] }}</p>
      </div>

      <!-- Total Rooms -->
      <div>
        <label class="label"><i class="fas fa-door-closed"></i> Total Rooms</label>
        <input type="number" formControlName="total_rooms" class="input-small" />
        <p *ngIf="form.get('total_rooms')?.touched && form.get('total_rooms')?.hasError('required')" class="text-red-600 text-sm">Total rooms is required.</p>
        <p *ngIf="form.get('total_rooms')?.errors?.['server']" class="text-red-600 text-sm">{{ form.get('total_rooms')?.errors?.['server'] }}</p>
      </div>

      <!-- Available Rooms -->
      <div>
        <label class="label"><i class="fas fa-door-open"></i> Available Rooms</label>
        <input type="number" formControlName="available_rooms" class="input-small" />
        <p *ngIf="form.get('available_rooms')?.touched && form.get('available_rooms')?.hasError('required')" class="text-red-600 text-sm">Available rooms is required.</p>
        <p *ngIf="form.get('available_rooms')?.errors?.['server']" class="text-red-600 text-sm">{{ form.get('available_rooms')?.errors?.['server'] }}</p>
      </div>

      <!-- Available Spots -->
      <div>
        <label class="label"><i class="fas fa-users"></i> Available Spots</label>
        <input type="number" formControlName="available_spots" class="input-small" />
        <p *ngIf="form.get('available_spots')?.touched && form.get('available_spots')?.hasError('required')" class="text-red-600 text-sm">Available spots is required.</p>
        <p *ngIf="form.get('available_spots')?.errors?.['server']" class="text-red-600 text-sm">{{ form.get('available_spots')?.errors?.['server'] }}</p>
      </div>

      <!-- Size -->
      <div>
        <label class="label"><i class="fas fa-ruler-combined"></i> Size (mÂ²)</label>
        <input type="number" formControlName="size" class="input-small" />
        <p *ngIf="form.get('size')?.touched && form.get('size')?.hasError('min')" class="text-red-600 text-sm">Minimum size is 1 mÂ².</p>
        <p *ngIf="form.get('size')?.errors?.['server']" class="text-red-600 text-sm">{{ form.get('size')?.errors?.['server'] }}</p>
      </div>

      <!-- Accommodation Type -->
      <div>
        <label class="label">Accommodation Type</label>
        <select formControlName="accommodation_type" class="input-small">
          <option value="apartment">Apartment</option>
          <option value="studio">Studio</option>
          <option value="room">Room</option>
        </select>
      </div>

      <!-- University -->
      <div>
        <label class="label"><i class="fas fa-university"></i> University</label>
        <input type="text" formControlName="university" class="input-small" />
      </div>
    </div>

    <!-- PRICE & REQUIREMENTS -->
    <h2 class="text-xl font-semibold flex items-center gap-2">
      <i class="fas fa-money-bill text-orange-500"></i> Pricing & Requirements
    </h2>

    <div class="grid grid-cols-1 md:grid-cols-3 gap-6 p-6 border border-gray-300 rounded-xl dark:border-gray-700 bg-gray-50 dark:bg-gray-800">
      <!-- Furnished -->
      <div>
        <label class="label">Furnished</label>
        <div class="toggle-container">
          <button type="button" (click)="setToggle('furnished', true)" [class.active]="form.value.furnished === true">Yes</button>
          <button type="button" (click)="setToggle('furnished', false)" [class.active-red]="form.value.furnished === false">No</button>
        </div>
      </div>

      <!-- Price -->
      <div>
        <label class="label"><i class="fas fa-tag"></i> Price (EGP/Month)</label>
        <input type="number" formControlName="price" class="input-small" />
        <p *ngIf="form.get('price')?.touched && form.get('price')?.hasError('required')" class="text-red-600 text-sm">Price is required.</p>
        <p *ngIf="form.get('price')?.errors?.['server']" class="text-red-600 text-sm">{{ form.get('price')?.errors?.['server'] }}</p>
      </div>

      <!-- Gender Requirement -->
      <div>
        <label class="label"><i class="fas fa-venus-mars"></i> Gender Requirement</label>
        <select formControlName="gender_requirement" class="input-small">
          <option value="male">Male</option>
          <option value="female">Female</option>
          <option value="mixed">Mixed</option>
        </select>
      </div>
    </div>

    <!-- AVAILABILITY -->
    <h2 class="text-xl font-semibold flex items-center gap-2">
      <i class="fas fa-calendar text-orange-500"></i> Availability Period
    </h2>

    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
      <!-- Available From -->
      <div>
        <label class="label">Available From</label>
        <input type="date" formControlName="available_from" class="input-field" />
        <p *ngIf="form.get('available_from')?.touched && form.get('available_from')?.hasError('pastDate')" class="text-red-600 text-sm">Start date cannot be in the past.</p>
        <p *ngIf="form.get('available_from')?.errors?.['server']" class="text-red-600 text-sm">{{ form.get('available_from')?.errors?.['server'] }}</p>
      </div>

      <!-- Available To -->
      <div>
        <label class="label">Available To</label>
        <input type="date" formControlName="available_to" class="input-field" /><p *ngIf="form.errors?.['invalidRange'] && form.get('available_to')?.touched" class="text-red-600 text-sm">End date must be after start date.</p>
        <p *ngIf="form.get('available_to')?.errors?.['server']" class="text-red-600 text-sm">{{ form.get('available_to')?.errors?.['server'] }}</p>
      </div>
    </div>

    <!-- ðŸŸ§ PREFERENCES -->
<h2 class="text-xl font-semibold flex items-center gap-2">
  <i class="fas fa-user-check text-orange-500"></i> Preferences
</h2>

<div class="grid grid-cols-1 md:grid-cols-2 gap-6 p-6 border border-gray-300 rounded-xl dark:border-gray-700">

  <div>
    <label class="label">Pets Allowed?</label>
    <div class="toggle-container">
      <button type="button" (click)="setToggle('pets_allowed', true)" [class.active]="form.value.pets_allowed">Yes</button>
      <button type="button" (click)="setToggle('pets_allowed', false)" [class.active-red]="!form.value.pets_allowed">No</button>
    </div>
    <p *ngIf="form.get('pets_allowed')?.errors?.['required'] && form.get('pets_allowed')?.touched" class="text-red-600 text-sm">
      Please specify if pets are allowed.
    </p>
  </div>

  <div>
    <label class="label">Smoking Allowed?</label>
    <div class="toggle-container">
      <button type="button" (click)="setToggle('smoking_allowed', true)" [class.active]="form.value.smoking_allowed">Yes</button>
      <button type="button" (click)="setToggle('smoking_allowed', false)" [class.active-red]="!form.value.smoking_allowed">No</button>
    </div>
    <p *ngIf="form.get('smoking_allowed')?.errors?.['required'] && form.get('smoking_allowed')?.touched" class="text-red-600 text-sm">
      Please specify if smoking is allowed.
    </p>
  </div>

</div>

<!-- ðŸŸ§ AMENITIES -->
<h2 class="text-xl font-semibold flex items-center gap-2">
  <i class="fas fa-couch text-orange-500"></i> Amenities
</h2>

<div class="grid grid-cols-2 md:grid-cols-3 gap-4 p-6 border border-gray-300 rounded-xl dark:border-gray-700">
  <label class="flex items-center gap-3 dark:text-gray-200" *ngFor="let amenity of [1,3,5,7,9]; let i = index">
    <input type="checkbox" [value]="amenity" (change)="toggleAmenity($event)" class="accent-orange-500" />
    {{ ['Wifi','TV','Balcony','Oven','Air Conditioner'][i] }}
  </label>
</div>
<p *ngIf="form.get('amenities')?.errors?.['required'] && form.get('amenities')?.touched" class="text-red-600 text-sm">
  Please select at least one amenity.
</p>
<p *ngIf="form.get('amenities')?.errors?.['server']" class="text-red-600 text-sm">{{ form.get('amenities')?.errors?.['server'] }}</p>

<!-- ðŸŸ§ PAYMENT METHODS -->
<h2 class="text-xl font-semibold flex items-center gap-2">
  <i class="fas fa-credit-card text-orange-500"></i> Payment Methods
</h2>

<div class="flex gap-3 flex-wrap">
  <span *ngFor="let option of paymentOptions"
        class="payment-pill"
        [class.active]="form.value.payment_methods.includes(option.id)"
        (click)="togglePayment(option.id)">
    {{ option.label }}
  </span>
</div>
<p *ngIf="form.get('payment_methods')?.errors?.['required'] && form.get('payment_methods')?.touched" class="text-red-600 text-sm">
  Please select at least one payment method.
</p>
<p *ngIf="form.get('payment_methods')?.errors?.['server']" class="text-red-600 text-sm">{{ form.get('payment_methods')?.errors?.['server'] }}</p>



<!-- ðŸŸ§ IMAGE UPLOAD -->
<h2 class="text-xl font-semibold flex items-center gap-2">
  <i class="fas fa-images text-orange-500"></i> Images
</h2>

<div
  class="border-2 border-dashed border-orange-400 rounded-xl p-10 flex flex-col justify-center items-center cursor-pointer dark:border-orange-600"
  (click)="fileInput.click()"
  (dragover)="onDragOver($event)"
  (drop)="onFileDrop($event)"
>
  <input #fileInput type="file" accept="image/*" multiple class="hidden" (change)="onFileSelect($event)" />

  <i class="fas fa-cloud-upload-alt text-4xl text-orange-500"></i>
  <p class="mt-2 text-gray-700 dark:text-gray-300">Upload Images (max 6)</p>
</div>
<p *ngIf="form.get('images')?.errors?.['required'] && form.get('images')?.touched" class="text-red-600 text-sm">
  Please upload at least one image.
</p>
<p *ngIf="form.get('images')?.errors?.['server']" class="text-red-600 text-sm">{{ form.get('images')?.errors?.['server'] }}</p>

<div class="mt-4 grid grid-cols-3 gap-4" *ngIf="previewImages.length > 0">
  <div *ngFor="let img of previewImages; let i = index" class="relative w-full h-32">
    <img [src]="img" class="w-full h-full object-cover rounded-xl border border-gray-300 dark:border-gray-700" />
    <button type="button" class="absolute -top-2 -right-2 bg-orange-500 text-white rounded-full w-6 h-6 flex items-center justify-center text-xs" (click)="removeImage(i)">âœ•</button>
  </div>
</div>


    <!-- SUBMIT BUTTON -->
    <button type="button" (click)="submitForm()" class="px-10 py-3 bg-orange-500 text-white rounded-full text-lg hover:bg-orange-600">
      Submit Listing
    </button>

  </form>
</div>
