<section  class="w-full py-16 bg-white dark:bg-gray-900 transition-colors">
  <!-- Header -->
  <div class="text-center md:text-start max-w-7xl mx-auto mb-12">
    <h2 class="text-purple-600 font-semibold text-lg dark:text-purple-400">
      Popular Locations
    </h2>

    <!-- Locations Filter -->
    <div id="popular-section" class="flex space-x-4 mt-6 overflow-x-auto pb-2">
      @for (city of cities; track $index) {
      <button
        (click)="selectCity(city)"
        class="px-4 py-2 rounded-full border transition-all text-sm font-medium border-gray-300 dark:border-gray-700 text-gray-700 dark:text-gray-300 hover:bg-purple-600 hover:text-white dark:hover:bg-purple-500 whitespace-nowrap"
        [class.bg-purple-600]="selectedCity === city"
        [class.text-white]="selectedCity === city"
      >
        {{ city }}
      </button>
      }
    </div>
  </div>

  <!-- Cards -->
  <div

    class="max-w-7xl mx-auto px-6 mt-10 grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6"
  >
    @if (topLocations.length === 0) {
    <p class="text-gray-600 dark:text-gray-300 col-span-full">No locations found.</p>
    } @for (place of paginatedProperties; track place.id) {

    <div
      class="group relative bg-white border border-gray-200 dark:border-gray-700 dark:bg-gray-800 rounded-2xl shadow-lg overflow-hidden hover:shadow-xl transition-all"
    >
      <!-- Quick View Button -->
      <button
        (click)="openQuickView(place)"
        class="absolute top-3 right-3 bg-purple-600 text-white px-3 py-1 rounded-lg text-xs opacity-0 group-hover:opacity-100 transition-all z-20"
      >
        Quick View
      </button>

      <!-- Image (shorter height) -->
      <img
        [src]="place.image"
        alt="Location"
        class="h-36 w-full object-cover transition-all group-hover:brightness-75"
      />

      <!-- Content -->
      <div class="p-4">
        <!-- Title & City -->
        <div>
          <h3 class="text-md font-semibold text-gray-900 dark:text-white line-clamp-1">
            {{ place.title }}
          </h3>
          <p class="text-gray-600 dark:text-gray-300 text-sm">{{ place.city }}</p>
        </div>

        <!-- Features (small icons) -->
        <div class="mt-3 flex items-center justify-between text-xs text-gray-700 dark:text-gray-300">
          <div class="flex items-center gap-1">
            <i class="fa-solid fa-bath text-[13px]"></i> {{ place.bathrooms_count }}
          </div>

          <div class="flex items-center gap-1">
            <i class="fa-solid fa-door-open text-[13px]"></i> {{ place.total_rooms }}
          </div>

          <div class="flex items-center gap-1">
            <i class="fa-solid fa-bed text-[13px]"></i> {{ place.beds }}
          </div>
        </div>

      <!-- Price + View -->
<div class="mt-4 flex items-center justify-between">
  <!-- Price -->
  <p class="text-[15px] font-bold text-purple-600 dark:text-purple-400">
    {{ place.price }}
    <span class="text-xs text-gray-500 dark:text-gray-300">/ Month</span>
  </p>

  <!-- View Button -->
  <button
    (click)="goToProperty(place.id)"
    class="px-4 py-2 rounded-xl font-medium
           bg-purple-600 text-white shadow-md
           hover:bg-purple-700 hover:shadow-lg
           transition-all duration-300 active:scale-95"
  >
    View
  </button>
</div>

      </div>
    </div>
    }
  </div>

  <!-- Quick View Modal -->
  @if (quickViewData) {
  <div
    class="fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-[999]"
    (click)="closeQuickView()"
  >
    <div
      class="bg-white dark:bg-gray-900 rounded-2xl p-6 w-11/12 max-w-lg shadow-xl relative animate-[fadeIn_.25s_ease-out]"
      (click)="$event.stopPropagation()"
    >
      <!-- Close -->
      <button
        class="absolute top-3 right-3 text-gray-500 hover:text-red-500 text-lg"
        (click)="closeQuickView()"
      >
        <i class="fa-solid fa-xmark"></i>
      </button>

      <!-- Image -->
      <img
        [src]="quickViewData.image"
        class="w-full h-56 object-cover rounded-xl"
      />

      <!-- Title -->
      <h2 class="mt-4 text-2xl font-bold text-gray-900 dark:text-white">
        {{ quickViewData.title }}
      </h2>
      <p class="text-gray-600 dark:text-gray-300">{{ quickViewData.city }}</p>

      <!-- Description -->
      <p class="mt-3 text-gray-700 dark:text-gray-300 text-sm leading-relaxed">
        {{ quickViewData.description || 'No description available for this property.' }}
      </p>

      <!-- Features -->
      <div class="grid grid-cols-3 gap-4 mt-4 text-gray-700 dark:text-gray-300 text-sm">
        <div><i class="fa-solid fa-bath"></i> {{ quickViewData.bathrooms_count }} Bath</div>
        <div><i class="fa-solid fa-door-open"></i> {{ quickViewData.total_rooms }} Room</div>
        <div><i class="fa-solid fa-bed"></i> {{ quickViewData.beds }} Beds</div>
      </div>

      <!-- Price & Rating -->
      <div class="mt-5 flex justify-between items-center">
        <p class="text-lg font-extrabold text-purple-600 dark:text-purple-400">
          {{ quickViewData.price }} <span class="text-sm">/ Month</span>
        </p>

        <p class="flex items-center gap-1 text-gray-600 dark:text-gray-300">
          {{ quickViewData.rating }}
          <i class="fa-solid fa-star text-[#14E076]"></i>
        </p>
      </div>

      <!-- View Property Button -->
      <button
        (click)="goToProperty(quickViewData.id)"
        class="mt-6 w-full bg-purple-600 hover:bg-purple-700 text-white py-3 rounded-xl font-medium transition"
      >
        View This Property
      </button>
    </div>
  </div>
  }
  <!-- Pagination -->
<div *ngIf="totalPages > 1" class="flex justify-center items-center mt-10 gap-2">

  <!-- Prev -->
  <button
    (click)="prevPage()"
    [disabled]="currentPage === 1"
    class="px-4 py-2 rounded-lg text-sm font-medium border
           bg-white dark:bg-gray-800
           hover:bg-gray-100 dark:hover:bg-gray-700
           disabled:opacity-40 disabled:cursor-not-allowed
           transition shadow-sm">
    ← Prev
  </button>

  <!-- Page Numbers -->
  <button
    *ngFor="let page of [].constructor(totalPages); let i = index"
    (click)="goToPage(i+1)"
    [ngClass]="{
      'bg-[#9810fa] text-white': currentPage === i+1,
      'bg-white dark:bg-gray-800 text-gray-700 dark:text-gray-300': currentPage !== i+1
    }"
    class="px-4 py-2 rounded-lg text-sm font-semibold border
           hover:bg-[#9810fa] hover:text-white transition shadow-sm">
    {{ i + 1 }}
  </button>

  <!-- Next -->
  <button
    (click)="nextPage()"
    [disabled]="currentPage === totalPages"
    class="px-4 py-2 rounded-lg text-sm font-medium border
           bg-white dark:bg-gray-800
           hover:bg-gray-100 dark:hover:bg-gray-700
           disabled:opacity-40 disabled:cursor-not-allowed
           transition shadow-sm">
    Next →
  </button>

</div>
</section>
